boxplot(no2data$log.no2, ylab="log.no2",col="green")
no2data <- read.table("http://www.uio.no/studier/emner/matnat/math/STK4900/v19/mandatory/no2.txt",sep="\t",header=TRUE)
no2data <- read.table("http://www.uio.no/studier/emner/matnat/math/STK4900/v19/mandatory/no2.txt",sep="\t",header=TRUE)
#a)
plot(no2data)
#a)
summary(no2data$log.no2)
summary(no2data$log.cars)
boxplot(no2data$log.no2, ylab="log.no2",col="green")
boxplot(no2data$log.cars, ylab="log.cars",col="red")
boxplot(no2data$log.cars, ylab="log.cars",col="red")
boxplot(no2data$log.no2, ylab="log.no2",col="green")
plot(log.no2~log.cars,data=no2data)
title("log.no2 vs log.cars")
boxplot(no2data$log.no2, ylab="log.no2",col="green")
boxplot(no2data$log.no2, ylab="log.no2",col="green")
title("Distribution of log.no2")
boxplot(no2data$log.cars, ylab="log.cars",col="red")
title("Distribution of log.cars")
plot(log.no2~log.cars,data=no2data)
title("log.no2 vs log.cars")
#b)
fit = lm(log.no2~log.cars,data=no2data)
summary(fit)
plot(log.no2~log.cars,data=no2data,col="grey")
abline(fit)
title("Linear Regression of log.no2 and log.cars")
xtable(fit)
library(xtable)
xtable(fit)
fit
xtable(summary(fit))
summary(fit)
#CPR plot to check linearity
library(car)
crPlots(fit,terms=~log.cars)
install.packages("car")
#CPR plot to check linearity
library(car)
crPlots(fit,terms=~log.cars)
title("CPR plot of log.cars")
#Check of Homoscedasticity
standardres = rstandard(fit)
fit.standardres = lm(sqrt(abs(standardres))~fit$fit)
plot(fit$fit,sqrt(abs(standardres)),xlab="Fitted Values",ylab=expression(sqrt |Standard Residuals|)
plot(fit$fit,sqrt(abs(standardres)),xlab="Fitted Values",ylab=expression(sqrt |Standard Residuals|))
plot(fit$fit,sqrt(abs(standardres)),xlab="Fitted Values",ylab=expression(sqrt |"Standard Residuals"|))
plot(fit$fit,sqrt(abs(standardres)),xlab="Fitted Values",ylab=expression(sqrt |"Standard Residuals"|)))
plot(fit$fit,sqrt(abs(standardres)),xlab="Fitted Values",ylab=expression(sqrt |"Standard Residuals"|))
plot(fit$fit,sqrt(abs(standardres)),xlab="Fitted Values",ylab=expression(sqrt |"Standard Residuals"|))
plot(fit$fit,sqrt(abs(standardres)),xlab="Fitted Values",ylab=""))#expression(sqrt |"Standard Residuals"|))
plot(fit$fit,sqrt(abs(standardres)),xlab="Fitted Values",ylab="")#expression(sqrt |"Standard Residuals"|))
plot(fit$fit,sqrt(abs(standardres)),xlab="Fitted Values",ylab="sqrt(|Standard Residuals|)")
abline(fit.standardres)
title("Homoscedasticity Plot with Standarized Residuals")
title("Homoscedasticity Plot with Standardized Residuals")
fit.standardres = lm(sqrt(abs(standardres))~fit$fit)
plot(fit$fit,sqrt(abs(standardres)),xlab="Fitted Values",ylab="sqrt(|Standard Residuals|)")
abline(fit.standardres)
title("Homoscedasticity Plot with Standardized Residuals")
#Check for normality
hist(fit$res,breaks=(1+3.322*log(length(fit$res))))
boxplot(fit$res)
qqnorm(fit$res);qqline(fit$res)
boxplot(fit$res,c="grey")
boxplot(fit$res,c="gray")
boxplot(fit$res,c="marine")
boxplot(fit$res,c="blue")
boxplot(fit$res,col="blue")
boxplot(fit$res,col="marine")
boxplot(fit$res,col="grey")
boxplot(fit$res,col="grey",ylab="Residual")
#Check for normality
hist(fit$res,breaks=(1+3.322*log(length(fit$res))),col="blue")
title("Distribution of the Residuals")
#Check for normality
hist(fit$res,breaks=(1+3.322*log(length(fit$res))),col="blue")
boxplot(fit$res,col="grey",ylab="Residual")
title("Distribution of the Residuals")
qqnorm(fit$res);qqline(fit$res)
#Check for normality
hist(fit$res,breaks=(1+3.322*log(length(fit$res))),col="blue")
boxplot(fit$res,col="grey",ylab="Residual")
title("Distribution of the Residuals")
qqnorm(fit$res);qqline(fit$res)
